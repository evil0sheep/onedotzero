---
- name: Create /opt/scripts
  ansible.builtin.file:
    path: /opt/scripts
    state: directory
    owner: root
    group: root
    mode: "0755"

- name: Create ray startup script
  ansible.builtin.template:
    src: start_ray.sh.j2
    dest: /opt/scripts/start_ray.sh
    owner: root
    group: root
    mode: "0755"

- name: Create systemd service file for Ray Worker node
  ansible.builtin.template:
    src: ray.service.j2
    dest: /etc/systemd/system/ray.service
    owner: root
    group: root
    mode: "0644"
  notify:
    - Systemd_daemon_reload

- name: Enable and start Ray Worker service
  ansible.builtin.systemd:
    name: ray
    state: started
    enabled: true
  tags:
    - start-ray
